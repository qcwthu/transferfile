06/17/2022 15:53:31 - INFO - __main__ - Namespace(task_dir='data/dbpedia_14/', task_name='dbpedia_14', identifier='T5-large-multitask-cls2cls-5e-1-4-10-up64shot', train_file='data', dev_file='data', test_file='data', dataset='nlp_forest_single', output_dir='models/T5-large-multitask-cls2cls-5e-1-4-10-up64shot/singletask-dbpedia_14', do_train=True, do_predict=True, predict_checkpoint='best-model.pt', checkpoint='models/upstream-multitask-cls2cls-5e-1-4-10-64shot/last-model.pt', do_lowercase=False, freeze_embeds=False, max_input_length=512, max_output_length=128, num_beams=4, append_another_bos=False, train_batch_size=4, predict_batch_size=16, learning_rate=0.5, weight_decay=1e-05, adam_epsilon=1e-08, max_grad_norm=1.0, gradient_accumulation_steps=1, num_train_epochs=1000.0, warmup_steps=50, total_steps=3000, wait_step=10000000000, quiet=False, eval_period=50, prefix='', debug=False, seed=42, learning_rate_list=[0.5, 0.4, 0.3, 0.2], bsz_list=[8], cache_dir='/export/share/sjoty/continual-learning/cache/', local_rank=0, log_step=10, lm_adapted_path='/export/share/sjoty/continual-learning/lm_adapted_model/torch_ckpt/large/pytorch_model.bin', model='google/t5-v1_1-large', prompt_number=100, cuda='4,5')
06/17/2022 15:53:31 - INFO - __main__ - models/T5-large-multitask-cls2cls-5e-1-4-10-up64shot/singletask-dbpedia_14
06/17/2022 15:53:32 - INFO - __main__ - Namespace(task_dir='data/dbpedia_14/', task_name='dbpedia_14', identifier='T5-large-multitask-cls2cls-5e-1-4-10-up64shot', train_file='data', dev_file='data', test_file='data', dataset='nlp_forest_single', output_dir='models/T5-large-multitask-cls2cls-5e-1-4-10-up64shot/singletask-dbpedia_14', do_train=True, do_predict=True, predict_checkpoint='best-model.pt', checkpoint='models/upstream-multitask-cls2cls-5e-1-4-10-64shot/last-model.pt', do_lowercase=False, freeze_embeds=False, max_input_length=512, max_output_length=128, num_beams=4, append_another_bos=False, train_batch_size=4, predict_batch_size=16, learning_rate=0.5, weight_decay=1e-05, adam_epsilon=1e-08, max_grad_norm=1.0, gradient_accumulation_steps=1, num_train_epochs=1000.0, warmup_steps=50, total_steps=3000, wait_step=10000000000, quiet=False, eval_period=50, prefix='', debug=False, seed=42, learning_rate_list=[0.5, 0.4, 0.3, 0.2], bsz_list=[8], cache_dir='/export/share/sjoty/continual-learning/cache/', local_rank=1, log_step=10, lm_adapted_path='/export/share/sjoty/continual-learning/lm_adapted_model/torch_ckpt/large/pytorch_model.bin', model='google/t5-v1_1-large', prompt_number=100, cuda='4,5')
06/17/2022 15:53:32 - INFO - __main__ - models/T5-large-multitask-cls2cls-5e-1-4-10-up64shot/singletask-dbpedia_14
06/17/2022 15:53:32 - INFO - root - Added key: store_based_barrier_key:1 to store for rank: 1
06/17/2022 15:53:32 - INFO - root - Added key: store_based_barrier_key:1 to store for rank: 0
06/17/2022 15:53:32 - INFO - __main__ - args.device: cuda:0
06/17/2022 15:53:32 - INFO - __main__ - Using 2 gpus
06/17/2022 15:53:32 - INFO - __main__ - Fine-tuning the following samples: ['dbpedia_14_16_100', 'dbpedia_14_16_13', 'dbpedia_14_16_21', 'dbpedia_14_16_42', 'dbpedia_14_16_87']
06/17/2022 15:53:32 - INFO - __main__ - args.device: cuda:1
06/17/2022 15:53:32 - INFO - __main__ - Using 2 gpus
06/17/2022 15:53:32 - INFO - __main__ - Fine-tuning the following samples: ['dbpedia_14_16_100', 'dbpedia_14_16_13', 'dbpedia_14_16_21', 'dbpedia_14_16_42', 'dbpedia_14_16_87']
06/17/2022 15:53:37 - INFO - __main__ - Running ... prefix=dbpedia_14_16_100, lr=0.5, bsz=8 ...
06/17/2022 15:53:37 - INFO - __main__ - Start tokenizing ... 224 instances
06/17/2022 15:53:37 - INFO - __main__ - Printing 3 examples
06/17/2022 15:53:37 - INFO - __main__ -  [dbpedia_14] Linnaemyini is a tribe of flies in the family Tachinidae.
06/17/2022 15:53:37 - INFO - __main__ - ['Animal']
06/17/2022 15:53:37 - INFO - __main__ -  [dbpedia_14] Morula ambrosia is a species of sea snail a marine gastropod mollusk in the family Muricidae the murex snails or rock snails.
06/17/2022 15:53:37 - INFO - __main__ - ['Animal']
06/17/2022 15:53:37 - INFO - __main__ -  [dbpedia_14] Neoduma plagosus is a moth of the Arctiidae family. It was described by Rothschild in 1912. It is found in New Guinea.The length of the forewings 10 mm. The forewings are creamy white with a yellow costa. The basal half of the wings is edged with black and there are two olive-grey antemedian patches as well as one on the termen. The hindwings are buff.
06/17/2022 15:53:37 - INFO - __main__ - ['Animal']
06/17/2022 15:53:37 - INFO - __main__ - Tokenizing Input ...
06/17/2022 15:53:37 - INFO - __main__ - Start tokenizing ... 224 instances
06/17/2022 15:53:37 - INFO - __main__ - Printing 3 examples
06/17/2022 15:53:37 - INFO - __main__ -  [dbpedia_14] Linnaemyini is a tribe of flies in the family Tachinidae.
06/17/2022 15:53:37 - INFO - __main__ - ['Animal']
06/17/2022 15:53:37 - INFO - __main__ -  [dbpedia_14] Morula ambrosia is a species of sea snail a marine gastropod mollusk in the family Muricidae the murex snails or rock snails.
06/17/2022 15:53:37 - INFO - __main__ - ['Animal']
06/17/2022 15:53:37 - INFO - __main__ -  [dbpedia_14] Neoduma plagosus is a moth of the Arctiidae family. It was described by Rothschild in 1912. It is found in New Guinea.The length of the forewings 10 mm. The forewings are creamy white with a yellow costa. The basal half of the wings is edged with black and there are two olive-grey antemedian patches as well as one on the termen. The hindwings are buff.
06/17/2022 15:53:37 - INFO - __main__ - ['Animal']
06/17/2022 15:53:37 - INFO - __main__ - Tokenizing Input ...
06/17/2022 15:53:38 - INFO - __main__ - Tokenizing Output ...
06/17/2022 15:53:38 - INFO - __main__ - Tokenizing Output ...
06/17/2022 15:53:38 - INFO - __main__ - Loaded 224 examples from train data
06/17/2022 15:53:38 - INFO - __main__ - Start tokenizing ... 224 instances
06/17/2022 15:53:38 - INFO - __main__ - Printing 3 examples
06/17/2022 15:53:38 - INFO - __main__ -  [dbpedia_14] Mesoscincus is a genus comprising three species of skink native to Mexico and Central America. They were formerly included in the genus Eumeces.
06/17/2022 15:53:38 - INFO - __main__ - ['Animal']
06/17/2022 15:53:38 - INFO - __main__ -  [dbpedia_14] Oxynoemacheilus leontinae is a species of stone loach found in Israel Jordan Lebanon and Syria.Its natural habitat is rivers.
06/17/2022 15:53:38 - INFO - __main__ - ['Animal']
06/17/2022 15:53:38 - INFO - __main__ -  [dbpedia_14] Syrmoptera homeyerii is a butterfly in the Lycaenidae family. It is found in the Democratic Republic of Congo (Uele Sankuru Lualaba Lomani Tanganika and Maniema) and Angola.
06/17/2022 15:53:38 - INFO - __main__ - ['Animal']
06/17/2022 15:53:38 - INFO - __main__ - Tokenizing Input ...
06/17/2022 15:53:38 - INFO - __main__ - Loaded 224 examples from train data
06/17/2022 15:53:38 - INFO - __main__ - Start tokenizing ... 224 instances
06/17/2022 15:53:38 - INFO - __main__ - Printing 3 examples
06/17/2022 15:53:38 - INFO - __main__ -  [dbpedia_14] Mesoscincus is a genus comprising three species of skink native to Mexico and Central America. They were formerly included in the genus Eumeces.
06/17/2022 15:53:38 - INFO - __main__ - ['Animal']
06/17/2022 15:53:38 - INFO - __main__ -  [dbpedia_14] Oxynoemacheilus leontinae is a species of stone loach found in Israel Jordan Lebanon and Syria.Its natural habitat is rivers.
06/17/2022 15:53:38 - INFO - __main__ - ['Animal']
06/17/2022 15:53:38 - INFO - __main__ -  [dbpedia_14] Syrmoptera homeyerii is a butterfly in the Lycaenidae family. It is found in the Democratic Republic of Congo (Uele Sankuru Lualaba Lomani Tanganika and Maniema) and Angola.
06/17/2022 15:53:38 - INFO - __main__ - ['Animal']
06/17/2022 15:53:38 - INFO - __main__ - Tokenizing Input ...
06/17/2022 15:53:38 - INFO - __main__ - Tokenizing Output ...
06/17/2022 15:53:38 - INFO - __main__ - Tokenizing Output ...
06/17/2022 15:53:38 - INFO - __main__ - Loaded 224 examples from dev data
06/17/2022 15:53:38 - INFO - __main__ - Loaded 224 examples from dev data
06/17/2022 15:53:56 - INFO - __main__ - load prompt embedding from ckpt
06/17/2022 15:53:56 - INFO - __main__ - load prompt embedding from ckpt
06/17/2022 15:53:57 - INFO - root - ShardedDDP bucket size: 8.00M parameters, model size 746.97M parameters
06/17/2022 15:53:57 - INFO - __main__ - Starting training!
06/17/2022 15:54:01 - INFO - root - ShardedDDP bucket size: 8.00M parameters, model size 746.97M parameters
06/17/2022 15:54:01 - INFO - __main__ - Starting training!
06/17/2022 15:54:06 - INFO - __main__ - Step 10 Global step 10 Train loss 6.48 on epoch=0
06/17/2022 15:54:08 - INFO - __main__ - Step 20 Global step 20 Train loss 4.64 on epoch=1
06/17/2022 15:54:11 - INFO - __main__ - Step 30 Global step 30 Train loss 3.91 on epoch=2
06/17/2022 15:54:13 - INFO - __main__ - Step 40 Global step 40 Train loss 3.55 on epoch=2
06/17/2022 15:54:16 - INFO - __main__ - Step 50 Global step 50 Train loss 3.06 on epoch=3
06/17/2022 15:54:21 - INFO - __main__ - Global step 50 Train loss 4.33 Classification-F1 0.09449715410666175 on epoch=3
06/17/2022 15:54:21 - INFO - __main__ - Saving model with best Classification-F1: -1.0 -> 0.09449715410666175 on epoch=3, global_step=50
06/17/2022 15:54:23 - INFO - __main__ - Step 60 Global step 60 Train loss 2.91 on epoch=4
06/17/2022 15:54:26 - INFO - __main__ - Step 70 Global step 70 Train loss 2.21 on epoch=4
06/17/2022 15:54:29 - INFO - __main__ - Step 80 Global step 80 Train loss 2.37 on epoch=5
06/17/2022 15:54:31 - INFO - __main__ - Step 90 Global step 90 Train loss 1.99 on epoch=6
06/17/2022 15:54:34 - INFO - __main__ - Step 100 Global step 100 Train loss 1.79 on epoch=7
06/17/2022 15:54:39 - INFO - __main__ - Global step 100 Train loss 2.26 Classification-F1 0.12245518216089807 on epoch=7
06/17/2022 15:54:39 - INFO - __main__ - Saving model with best Classification-F1: 0.09449715410666175 -> 0.12245518216089807 on epoch=7, global_step=100
06/17/2022 15:54:42 - INFO - __main__ - Step 110 Global step 110 Train loss 1.59 on epoch=7
06/17/2022 15:54:44 - INFO - __main__ - Step 120 Global step 120 Train loss 1.50 on epoch=8
06/17/2022 15:54:47 - INFO - __main__ - Step 130 Global step 130 Train loss 1.53 on epoch=9
06/17/2022 15:54:49 - INFO - __main__ - Step 140 Global step 140 Train loss 1.24 on epoch=9
06/17/2022 15:54:52 - INFO - __main__ - Step 150 Global step 150 Train loss 1.10 on epoch=10
06/17/2022 15:54:58 - INFO - __main__ - Global step 150 Train loss 1.39 Classification-F1 0.35281495838727894 on epoch=10
06/17/2022 15:54:58 - INFO - __main__ - Saving model with best Classification-F1: 0.12245518216089807 -> 0.35281495838727894 on epoch=10, global_step=150
06/17/2022 15:55:00 - INFO - __main__ - Step 160 Global step 160 Train loss 0.99 on epoch=11
06/17/2022 15:55:03 - INFO - __main__ - Step 170 Global step 170 Train loss 0.97 on epoch=12
06/17/2022 15:55:05 - INFO - __main__ - Step 180 Global step 180 Train loss 0.72 on epoch=12
06/17/2022 15:55:08 - INFO - __main__ - Step 190 Global step 190 Train loss 0.87 on epoch=13
06/17/2022 15:55:10 - INFO - __main__ - Step 200 Global step 200 Train loss 0.68 on epoch=14
06/17/2022 15:55:17 - INFO - __main__ - Global step 200 Train loss 0.85 Classification-F1 0.546381314268775 on epoch=14
06/17/2022 15:55:17 - INFO - __main__ - Saving model with best Classification-F1: 0.35281495838727894 -> 0.546381314268775 on epoch=14, global_step=200
06/17/2022 15:55:20 - INFO - __main__ - Step 210 Global step 210 Train loss 0.76 on epoch=14
06/17/2022 15:55:22 - INFO - __main__ - Step 220 Global step 220 Train loss 0.61 on epoch=15
06/17/2022 15:55:25 - INFO - __main__ - Step 230 Global step 230 Train loss 0.50 on epoch=16
06/17/2022 15:55:27 - INFO - __main__ - Step 240 Global step 240 Train loss 0.60 on epoch=17
06/17/2022 15:55:30 - INFO - __main__ - Step 250 Global step 250 Train loss 0.43 on epoch=17
06/17/2022 15:55:36 - INFO - __main__ - Global step 250 Train loss 0.58 Classification-F1 0.5899627675718758 on epoch=17
06/17/2022 15:55:36 - INFO - __main__ - Saving model with best Classification-F1: 0.546381314268775 -> 0.5899627675718758 on epoch=17, global_step=250
06/17/2022 15:55:39 - INFO - __main__ - Step 260 Global step 260 Train loss 0.43 on epoch=18
06/17/2022 15:55:41 - INFO - __main__ - Step 270 Global step 270 Train loss 0.38 on epoch=19
06/17/2022 15:55:44 - INFO - __main__ - Step 280 Global step 280 Train loss 0.40 on epoch=19
06/17/2022 15:55:46 - INFO - __main__ - Step 290 Global step 290 Train loss 0.41 on epoch=20
06/17/2022 15:55:49 - INFO - __main__ - Step 300 Global step 300 Train loss 0.32 on epoch=21
06/17/2022 15:55:56 - INFO - __main__ - Global step 300 Train loss 0.39 Classification-F1 0.7283117917526519 on epoch=21
06/17/2022 15:55:56 - INFO - __main__ - Saving model with best Classification-F1: 0.5899627675718758 -> 0.7283117917526519 on epoch=21, global_step=300
06/17/2022 15:55:58 - INFO - __main__ - Step 310 Global step 310 Train loss 0.37 on epoch=22
06/17/2022 15:56:01 - INFO - __main__ - Step 320 Global step 320 Train loss 0.28 on epoch=22
06/17/2022 15:56:04 - INFO - __main__ - Step 330 Global step 330 Train loss 0.42 on epoch=23
06/17/2022 15:56:06 - INFO - __main__ - Step 340 Global step 340 Train loss 0.25 on epoch=24
06/17/2022 15:56:09 - INFO - __main__ - Step 350 Global step 350 Train loss 0.32 on epoch=24
06/17/2022 15:56:15 - INFO - __main__ - Global step 350 Train loss 0.33 Classification-F1 0.6562202470122175 on epoch=24
06/17/2022 15:56:18 - INFO - __main__ - Step 360 Global step 360 Train loss 0.31 on epoch=25
06/17/2022 15:56:20 - INFO - __main__ - Step 370 Global step 370 Train loss 0.31 on epoch=26
06/17/2022 15:56:23 - INFO - __main__ - Step 380 Global step 380 Train loss 0.22 on epoch=27
06/17/2022 15:56:25 - INFO - __main__ - Step 390 Global step 390 Train loss 0.27 on epoch=27
06/17/2022 15:56:28 - INFO - __main__ - Step 400 Global step 400 Train loss 0.30 on epoch=28
06/17/2022 15:56:35 - INFO - __main__ - Global step 400 Train loss 0.28 Classification-F1 0.7081702845143705 on epoch=28
06/17/2022 15:56:37 - INFO - __main__ - Step 410 Global step 410 Train loss 0.23 on epoch=29
06/17/2022 15:56:40 - INFO - __main__ - Step 420 Global step 420 Train loss 0.23 on epoch=29
06/17/2022 15:56:43 - INFO - __main__ - Step 430 Global step 430 Train loss 0.29 on epoch=30
06/17/2022 15:56:45 - INFO - __main__ - Step 440 Global step 440 Train loss 0.20 on epoch=31
06/17/2022 15:56:48 - INFO - __main__ - Step 450 Global step 450 Train loss 0.17 on epoch=32
06/17/2022 15:56:55 - INFO - __main__ - Global step 450 Train loss 0.22 Classification-F1 0.7097366545184383 on epoch=32
06/17/2022 15:56:57 - INFO - __main__ - Step 460 Global step 460 Train loss 0.17 on epoch=32
06/17/2022 15:57:00 - INFO - __main__ - Step 470 Global step 470 Train loss 0.21 on epoch=33
06/17/2022 15:57:02 - INFO - __main__ - Step 480 Global step 480 Train loss 0.17 on epoch=34
06/17/2022 15:57:05 - INFO - __main__ - Step 490 Global step 490 Train loss 0.18 on epoch=34
06/17/2022 15:57:08 - INFO - __main__ - Step 500 Global step 500 Train loss 0.21 on epoch=35
